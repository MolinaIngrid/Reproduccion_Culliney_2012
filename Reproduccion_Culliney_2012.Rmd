---
title: "Reproducion_Culliney_2012"
author: "Ingrid Molina Mora"
date: "26/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# **Proyecto de Reproducción de Artículo**
## Seed dispersal by a captive corvid: the role of the Alala
## (Corvus hawaiiensis) in shaping Hawaii’s plant communities

<br><br><br><br>

#### Curso de Estrategias para la investigación reproducible II Semestre 2020 UCR

<br><br><br><br>

##### **1** Este artículo de 2012 documentó el potencial del papel del cuervo hawaiano Alalas en el mantenimiento y restauración de los bosques de Hawáia través de la dispersión de semillas. 

Usaron ensayos de alimentación con
Alalas cautivos para determinar (1) el potencial de dispersión del Alala en cautiverio para las especies de plantas fructíferas nativas de Hawaii; (2) si la edad y el sexo de las aves influyen en las opciones de alimentación
y dispersión de semillas; y (3) si la ingestión de Alala
da como resultado una mejor germinación de las semillas, ya que el proceso digestivo del ave podría preparar químicamente semillas para su germinación.

##### **2** ¿Qué parte del análisis se reprodujo y porqué?

reproduje las 3 partes del análisis porque en este caso el artículo brindaba un link a el set de datos y a tres documentos de word donde el código estaba bien explicado

##### **3** Código y resultados 

##### ***Comportamiento de forrajeo y dispersión de semillas***
   -Cargo las librerías MuMIn  y Betareg
   
```{r}
library(MuMIn)
```

Al cargar library(betareg) hubo un error puesto que hay que instalar primero el paquete betareg ***esto no estaba especificado en el documento de word*** una vez instalado:
```{r}
library(betareg)
```
Esta es una versión del paquete mucho más nueva que la utilizada por las investigadoras en 2012 y además Mi versión de R es 3.6.1. Decidí continuar y crear el objeto Alala.carry

```{r}
Alala.carry <- as.data.frame(read.delim(file="Data.Alala.carry.txt", header=TRUE, sep="\t"))
```
```{r}
names(Alala.carry)
unique(Alala.carry$Plant)
```


##### Hacer un sub set para Olapa. 

```{r}
CHETR <- subset(Alala.carry, Plant== "CHETR")

#Regresión; 
CHETR.glm <- glm(CHETR$carries~ CHETR$Sex + CHETR$Age,weights=CHETR$given, na.action = na.fail)
#Resumen de estadísticas
summary(CHETR.glm)
```

##### Tablas del AIC y sus coeficientes. Acá obtenía un error porque la función dredge no aceptaba el argumento "na.action". tuve que devolverme al glm y ***agregar glm(..., na.action = na.fail).***

```{r}
CHETR.AIC <- dredge(CHETR.glm)
#Valores del AIC
CHETR.AIC
```
##### Para promediar el modelo y obtener los estimados promediados del modelo para cada uno de los coeficientes. ***Hubo un error por el código original ya que la función model.avg ha tenido cambios y no requiere especificar el "method"***
```{r}
average.CHETR <- model.avg(get.models(CHETR.AIC, seq(nrow(CHETR.AIC))))
CHETR.Age <- CHETR$Age
CHETR.Sex <- CHETR$Sex
```

##### Para obtener los modelos promediados con los errores estandar 
```{r}
newdata.CHETR <- as.data.frame(cbind(CHETR.Age,CHETR.Sex))
pred.avg.CHETR <- predict(average.CHETR, newdata.CHETR,se.fit=TRUE, type="response")
results.CHETR <- unique(cbind(newdata.CHETR,pred.avg.CHETR$fit,pred.avg.CHETR$se.fit))
```
##### Archivo de texto 
```{r}

write.table(results.CHETR,"CARRY.results.CHETR.txt",sep="S", col.names=TRUE)
```